# ETL_bot

## –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π (Dag)

1. –î–æ–±–∞–≤—å—Ç–µ –Ω–æ–≤—É—é –æ–ø–µ—Ä–∞—Ü–∏—é –≤ —Ç–∞–±–ª–∏—Ü—É –∞–ª–µ—Ä—Ç–æ–≤ ***bot***:
    - [ ] alert_id - –∑–Ω–∞—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ id –ª–µ—Ä—Ç–∞ + 1
    - [ ] type_alert - –Ω–∞–∑–≤–∞–Ω–∏–µ –∞–ª–µ—Ä—Ç–∞, –º–æ–∂–Ω–æ –Ω–∞–∑–≤–∞—Ç—å —Ç–∞–∫ –∂–µ, –∫–∞–∫ –¥–æ–±–∞–≤–ª—è–µ–º–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è
    - [ ] role_access - —Å–ø–∏—Å–æ–∫ —Ä–æ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–º –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –∞–ª–µ—Ä—Ç—ã –¥–ª—è –¥–æ–±–∞–≤–ª—è–µ–º–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏
   

2. –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é –æ–ø–µ—Ä–∞—Ü–∏—é –≤ —Ç–∞–±–ª–∏—Ü—É **on:**
    - [ ] operation_name (–ø–∞—Ä–∞–º–µ—Ç—Ä –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è) - —É–∫–∞–∑–∞—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è –∫–Ω–æ–ø–∫–∏ –≤ –±–æ—Ç–µ
    - [ ] variables_dag - —É–∫–∞–∑–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏ –µ—Å–ª–∏ –µ—Å—Ç—å, –∏—Ö –∑–Ω–∞—á–µ–Ω–∏—è (–µ—Å–ª–∏ –¥–ª—è –æ–ø–µ—Ä–∞—Ü–∏–∏ –ø—Ä–∏—Å—É—â—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω–æ—á–Ω—ã–π –≤—ã–±–æ—Ä, —É–∫–∞–∑–∞—Ç—å —ç—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ –∫–∞–∫ —Å—Ç–æ—Ä–∫–∞ –∏–ª–∏ —á–∏—Å–ª–æ, –µ—Å–ª–∏ –ø—Ä–∏—Å—É—â –∏ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –∏ –æ–¥–∏–Ω–æ—á–Ω—ã–π –≤—ã–±–æ—Ä, —Ç–æ —É–∫–∞–∑–∞—Ç—å —ç—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ –º–æ–∂–Ω–æ –∏ –∫–∞–∫ —Å–ø–∏—Å–∫–æ)
    - [ ] timeout_operation_value - —É–∫–∞–∑–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, —á–µ—Ä–µ–∑ –∫–∞–∫–æ–µ –≤—Ä–µ–º—è –º–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç—å –æ–ø–µ—Ä–∞—Ü–∏—é
    - [ ] many_or_one_value - –ø–æ—Å—Ç–∞–≤–∏—Ç—å True –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
    - [ ] only_one_choose_value (–ø–∞—Ä–∞–º–µ—Ç—Ä –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è) - True: —Ä–∞–∑—Ä–µ—à–µ–Ω —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω–æ—á–Ω—ã–π —Ç–∏–ø –≤—ã–±–æ—Ä–∞, False: —Ä–∞–∑—Ä–µ—à–µ–Ω –∏ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –∏ –æ–¥–∏–Ω–æ—á–Ω—ã–π —Ç–∏–ø –≤—ã–±–æ—Ä–∞
    - [ ] variables_desc - –¥–æ–±–∞–≤–∏—Ç—å, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ –æ–ø–∏—Å–∞–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö —É –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏
    - [ ] operation_desc - –¥–æ–±–∞–≤–∏—Ç—å –æ–ø–∏—Å–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ - —á—Ç–æ –¥–µ–ª–∞–µ—Ç (–ü–∞—Ç–µ—Ä–Ω: –û–ø–µ—Ä–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç <—á—Ç–æ –¥–µ–ª–∞–µ—Ç>)

3. –í —Ñ–∞–π–ª–µ ***create_keyboard.py*** –¥–æ–±–∞–≤—å—Ç–µ –∫–Ω–æ–ø–∫—É —Å –æ–ø–µ—Ä–∞—Ü–∏–µ–π –≤ –Ω–æ–≤—ã–π —Ä–∞–∑–¥–µ–ª:
   - [ ] –ï—Å–ª–∏ —Ä–∞–∑–¥–µ–ª –ø–æ–¥ –æ–ø–µ—Ä–∞—Ü–∏—é —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, —Ç–æ –¥–æ–±–∞–≤—å—Ç–µ –≤ –Ω–µ–≥–æ –∫–Ω–æ–ø–∫—É:
     ```   
      elif message_text == '' and state == 'datamart_menue':
            markup = types.ReplyKeyboardMarkup(resize_keyboard=True, row_width=2)
            btn1 = types.KeyboardButton('–í–∏—Ç—Ä–∏–Ω–∞ –†–µ–≥–∏–æ–Ω–æ–≤ –†–§')
            btn2 = types.KeyboardButton('–í–∏—Ç—Ä–∏–Ω–∞ Year_Data')
            btn3 = types.KeyboardButton('–í–ê–®–ê –û–ü–ï–†–ê–¶–ò–Ø')
            btn10 = types.KeyboardButton('üö™ –í –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é')
            markup.add(btn1, btn2, btn3, btn10)
     ```
   - [ ] –ï—Å–ª–∏ —Ä–∞–∑–¥–µ–ª–∞ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ–π—Ç, —Ç–æ —Å–æ–∑–¥–∞–π—Ç–µ —Ä–∞–∑–¥–µ–ª –∏ –¥–æ–±–∞–≤—å—Ç–µ –≤ –Ω–µ–≥–æ –Ω–æ–≤—ã–µ –∫–Ω–æ–ø–∫–∏, –∞ —Ç–∞–∫ –∂–µ –≤–≤–µ–¥–∏—Ç–µ –∏–º—è state —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–µ —Ä–∞–∑–¥–µ–ª–∞ –∏ –¥–æ–±–∞–≤—Ç—å –∫–Ω–æ–ø–∫—É —Ä–∞–∑–¥–µ–ª—è –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é(state=main)
     ```   
      elif message_text == '' and state == '–í–ê–®_–†–ê–ó–î–ï–õ':
            markup = types.ReplyKeyboardMarkup(resize_keyboard=True, row_width=2)
            btn1 = types.KeyboardButton('–í–ê–®–ê –û–ü–ï–†–ê–¶–ò–Ø 1')
            btn2 = types.KeyboardButton('–í–ê–®–ê –û–ü–ï–†–ê–¶–ò–Ø 2')
            btn3 = types.KeyboardButton('üö™ –í –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é')
            markup.add(btn1, btn2, btn3)
     ``` 
   

4. –í —Ñ–∞–π–ª–µ ***help_variable.py*** –¥–æ–±–∞–≤—å—Ç–µ –Ω—É–∂–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏ –∏—Ö –∑–Ω–∞—á–µ–Ω–∏—è, –µ—Å–ª–∏ —Ç–∞–∫–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –µ—â–µ –Ω–µ—Ç –≤ —Å–ª–æ–≤–∞—Ä—è—Ö:
   - [ ] –í —Å–ª–æ–≤–∞—Ä—å params_dag_list. –í–∞–∂–Ω–æ, —á—Ç–æ–±—ã –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–ª—é—á–µ–π —Å–æ–≤–ø–∞–¥–∞–ª–∏ —Å –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –∑–∞–Ω–µ—Å–µ–Ω–Ω—ã–º–∏ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö. –¢–∞–∫ –∂–µ –≤—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–æ–ª–∂–Ω—ã –∏–º–µ—Ç—å —Ç–∏–ø ***str***:
      ```
     params_dag_list = {
                        '–ù–û–í–û–ï_–ó–ù–ê–ß–ï–ù–ò–ï_–ü–ê–†–ê–ú–ï–¢–†–ê 1': ['0', '1', '2', '3', '4'],
                        '–ù–û–í–û–ï_–ó–ù–ê–ß–ï–ù–ò–ï_–ü–ê–†–ê–ú–ï–¢–†–ê 2': ['–∞', '–±', '–≤', '–≥', '–¥']
                       }
     
     ``` 
   - [ ] –ï—Å–ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–≤—è–∑–∞–Ω—ã —Å —Ç–∏–ø–æ–º –¥–∞—Ç–∞ (–≥–æ–¥, –º–µ—Å—è—Ü, —á–∏—Å–ª–æ) –∏ —è–≤–ª—è—é—Ç—Å—è –ø–∞—Ä–Ω—ã–º–∏ (–¥–∞—Ç–∞ —Å—Ç–∞—Ä—Ç–∞, –¥–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è), —Ç–æ –∏—Ö –¥–æ–±–∞–≤–∏—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤ —Å–ª–æ–≤–∞—Ä—å ***params_dag_list_from_date***


5. –í —Ñ–∞–π–ª–µ ***main.py*** –Ω–µ–æ–±—Ö–æ–¥–∏–æ–º –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥ –¥–ª—è –Ω–æ–≤–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏. –ù–æ –ø–µ—Ä–µ–¥ —ç—Ç–∏–º –µ—Å–ª–∏ –Ω–∞—à–∞ –æ–ø–µ—Ä–∞—Ü–∏—è –Ω–æ—Å–∏—Ç –∑–∞–∫—Ä—ã—Ç—ã–π —Ö–∞—Ä–∞–∫—Ç–µ—Ä –∏ –¥–æ—Å—Ç—É–ø–Ω–∞ —Ç–æ–ª—å–∫–æ –¥–ª—è –≥–ª–∞–≤–Ω—ã—Ö –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤, —Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω_–±–æ—Ç–∞ –¥–æ–±–∞–≤–∏—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–Ω–æ–ø–∫—É –∫ —Ä–æ–ª–∏ admin –∏ –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ —Ä–∞–∑–¥–µ–ª –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω —Ç–æ–ª—å–∫–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º —Å —ç—Ç–æ–π —Ä–æ–ª—å—é(–ª–∏—Å—Ç–∏–Ω–≥ 1.). –ï—Å–ª–∏ –∂–µ –æ–ø–µ—Ä–∞—Ü–∏—è –Ω–µ –Ω–æ—Å–∏—Ç –∑–∞–∫—Ä—ã—Ç—ã–π —Ö–∞—Ä–∞–∫—Ç–µ—Ä, —Ç–æ –º–æ–∂–Ω–æ –Ω–µ –¥–æ–±–∞–≤–ª—è—Ç—å –∫–Ω–æ–ø–∫—É –∫ —Ä–æ–ª–∏ (–ª–∏—Å—Ç–∏–Ω–≥ 2.):
   - [ ] –ï—Å–ª–∏ –º—ã –¥–æ–±–∞–≤–ª—è–µ–º –æ–ø–µ—Ä–∞—Ü–∏—é –≤ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Ä–∞–∑–¥–µ–ª, —Ç–æ –Ω–∞—Ö–æ–¥–∏–º –µ–≥–æ –≤ —Ñ–∞–π–ª–∏ –∏ –≤—Å—Ç–∞–≤–ª—è–µ–º —Å–ª–µ–¥—É—é—â–∏–π –∫–æ–¥ –≤–≤–æ–¥—è –Ω—É–∂–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
      ```
     # –õ–∏—Å—Ç–∏–Ω–≥ 1. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è –∑–∞–∫—Ä—ã—Ç–æ–π —Ä–æ–ª–∏
      elif await need_example_class.get_access_section(chat_id, message_text[
                                                              2:]) and message_text == '–í–ê–®–ê –û–ü–ï–†–ê–¶–ò–Ø':
          await need_example_class.update_etl_choose_dag(chat_id, message_text, 'DAG_ID_IN_AIRFLOW')
          await need_example_class.update_state_user(chat_id, 'interaction_with_dag', True)
          await bot.send_message(chat_id, '–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ üëá',
                               reply_markup=create_replay_markup('', 'interaction_with_dag', 
                                                                flag_one_choose_value=await need_example_class.get_only_one_choose_value(message_text)))
     ``` 
     
    ```
         # –õ–∏—Å—Ç–∏–Ω–≥ 2. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
          elif await need_example_class.check_user(chat_id) and message_text == '–í–ê–®–ê –û–ü–ï–†–ê–¶–ò–Ø':
              await need_example_class.update_etl_choose_dag(chat_id, message_text, 'DAG_ID_IN_AIRFLOW')
              await need_example_class.update_state_user(chat_id, 'interaction_with_dag', True)
              await bot.send_message(chat_id, '–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ üëá',
                                   reply_markup=create_replay_markup('', 'interaction_with_dag', 
                                                                    flag_one_choose_value=await need_example_class.get_only_one_choose_value(message_text)))
    ``` 
   - [ ] –ï—Å–ª–∏ –º—ã –¥–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–π –±–ª–æ–∫ –∏ –Ω–æ–≤—É—é –æ–ø–µ—Ä–∞–∞—Ü–∏—é, —Ç–æ –º–æ–∂–Ω–æ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥ –ª—é–±–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ —É–∂–µ –∏–º–µ—é—â–µ–≥–æ—Å—è –±–ª–æ–∫–∞ –∏ –≤ –Ω–µ–º:
     - –ó–∞–º–µ–Ω–∏—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–∞ –Ω–∞–∑–≤–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –±–ª–æ–∫–∞ 
     - –ó–∞–º–µ–Ω–∏—Ç—å state –Ω–∞ –Ω–∞–∑–≤–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –±–ª–æ–∫–∞
     - –ü–æ–¥—Å—Ç–∞–≤–∏—Ç—å –Ω—É–∂–Ω—É—é –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—é 
       ```
          if 
             ...
          elif 
             ...
          else
             ...
       ``` 
